<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        button, input {
          -moz-appearance:none; /* Firefox */
          //-webkit-appearance:none; /* Safari and Chrome */
          //appearance:none;
          background-color: #F5F5F5;
          border-color: #D0D0D0;
        }
        html{
            width: 100%;
            height: 100%;
            margin: 0%;
            padding: 0%;
        }
        body{
            width: 100%;
            height: 100%;
            margin: 0%;
            padding: 0%;
        }
        .title{
            width: 100%;
            height: 5%;
            background-color: red;
        }
        .body{
            width: 98%;
            height: 95%;
            margin: 0% 1% 0% 1%;
        }
        .bodyLeft{
            display: inline-block;
            width: 65%;
            height: 100%;
            margin: 0% 5% 0% 0%;
        }
        .bodyLeftTop{
            width: 99.8%;
            height: 19.8%;
            display:flex;
            border: 1px solid black;
        }
        .bodyLeftTopTop{
            width: 20%;
            height: 100%;
            border-right: 1px solid black;
        }
        .bodyLeftTopTopTop{
            width: 100%;
            height: 50%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 30px;
            border-bottom: 1px solid black;
        }
        .bodyLeftTopTopBottom{
            width: 100%;
            height: 50%;
            display:flex;
        }
        .bodyLeftTopTopBottomLeft{
            width: 30%;
            height: 100%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 40px;
        }
        .bodyLeftTopTopBottomRight{
            width: 70%;
            height: 100%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 40px;
        }
        .bodyLeftTopMid{
            width: 60%;
            height: 100%;
            display:flex;
            border-right: 1px solid black;
        }
        .bodyLeftTopMid1{
            width: 20%;
            height:100%;
            margin: 0% 0% 0% 15%;
        }
        .bodyLeftTopMid1Top{
            width: 100%;
            height: 20%;
            display:flex;
        }
        .bodyLeftTopMid1Top1{
            width: 50%;
            height: 100%;
        }
        .bodyLeftTopMid1Top2{
            width: 50%;
            height: 100%;
        }
        .bodyLeftTopMid1Mid{
            width: 100%;
            height: 60%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 80px;
        }
        .bodyLeftTopMid1Bottom{
            width: 100%;
            height: 20%;
        }
        .bodyLeftTopMid1BottomInput{
            width: 95%;
            height: 90%;
            margin: 0%;
            padding: 0%;
        }
        .bodyLeftTopMid2{
            width: 5%;
            height:100%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 80px;
        }
        .bodyLeftTopMid3{
            width: 20%;
            height:100%;
        }
        .bodyLeftTopMid3Top{
            width: 100%;
            height: 20%;
            display:flex;
        }
        .bodyLeftTopMid3Top1{
            width: 50%;
            height: 100%;
        }
        .bodyLeftTopMid3Top2{
            width: 50%;
            height: 100%;
        }
        .bodyLeftTopMid3Mid{
            width: 100%;
            height: 60%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 80px;
        }
        .bodyLeftTopMid3Bottom{
            width: 100%;
            height: 20%;
        }
        .bodyLeftTopMid3BottomInput{
            width: 95%;
            height: 90%;
            margin: 0%;
            padding: 0%;
        }
        .bodyLeftTopMid4{
            width: 5%;
            height:100%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 80px;
        }
        .bodyLeftTopMid5{
            width: 20%;
            height:100%;
            margin: 0% 15% 0% 0%;
        }
        .bodyLeftTopMid5Top{
            width: 100%;
            height: 20%;
            display:flex;
        }
        .bodyLeftTopMid5Top1{
            width: 50%;
            height: 100%;
        }
        .bodyLeftTopMid5Top2{
            width: 50%;
            height: 100%;
        }
        .bodyLeftTopMid5Mid{
            width: 100%;
            height: 60%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 80px;
        }
        .bodyLeftTopMid5Bottom{
            width: 100%;
            height: 20%;
        }
        .bodyLeftTopMid5BottomInput{
            width: 95%;
            height: 90%;
            margin: 0%;
            padding: 0%;
        }
        .bodyLeftTopBottom{
            width: 20%;
            height: 100%;
        }
        .bodyLeftTopBottomTop{
            width: 100%;
            height: 33.3%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 50px;
            border-bottom: 1px solid black;
            cursor: pointer;
        }
        .bodyLeftTopBottomMid{
            width: 100%;
            height: 33.3%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 50px;
            border-bottom: 1px solid black;
            cursor: pointer;
        }
        .bodyLeftTopBottomBottom{
            width: 100%;
            height: 33.3%;
            display: flex;
        }
        .bodyLeftTopBottomBottomLeft{
            width: 50%;
            height: 100%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 30px;
            border-right:1px solid black;
            cursor: pointer;
        }
        .bodyLeftTopBottomBottomRight{
            width: 50%;
            height: 100%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 30px;
            cursor: pointer;
        }
        .bodyLeftMid{
            width: 100%;
            height: 70%;
        }
        .bodyLeftMidCanvas{
            width: 99.8%;
            height: 100%;
            border: 1px solid black;
        }
        .bodyLeftBottom{
            width: 100%;
            height: 10%;
            background-color: green;
        }
        .bodyRight{
            display: inline-block;
            float: right;
            width: 30%;
            height: 100%;
        }
        .bodyRightTop{
            width: 100%;
            height: 70%;
        }
        .bodyRightTopTop{
            width: 100%;
            height: 10%;
            text-align: center;
            display: grid;
            align-items: center;
            font-size: 40px;
        }
        .bodyRightTopBottom{
            width: 99.6%;
            height: 90%;
            border: 1px solid black;
            overflow-y: scroll;
        }
        .bodyRightTopBottomDiv{
            width: 100%;
            height: 16%;
            display: flex;
            margin: 2% 0% 2% 0%;
        }
        .bodyRightTopBottomDivLeft{
            width: 70%;
            height: 100%;
            display:flex;
        }
        .bodyRightTopBottomDivLeftLeft{
            width: 10%;
            height: 100%;
            display: grid;
            text-align: center;
            align-items: center;
        }
        bodyRightTopBottomDivLeftLeftClick{
            width: 100%;
            height: 100%;
        }
        .bodyRightTopBottomDivLeftRight{
            width: 85%;
            height: 100%;
            margin: 0% 0% 0% 5%;
            display: grid;
            align-items: center;
            font-size: 30px;
        }
        .bodyRightTopBottomDivRight{
            width: 30%;
            height: 100%;
        }
        .bodyRightTopBottomDivRightDiv{
            width: 90%;
            height: 100%;
            padding: 0% 10% 0% 0%;
        }
        .bodyRightTopBottomDivRightDiv1{
            float: right;
            width: 40%;
            height: 25%;
        }
        .bodyRightTopBottomDivRightDiv2{
            float: right;
            width: 40%;
            height: 25%;
        }
        .bodyRightBottom{
            width: 100%;
            height: 30%;
        }
        .bodyRightBottomDiv{
            width: 100%;
            height: 80.5%;
            padding: 10% 0% 0% 0%;
        }
        .bodyRightBottomDivTop{
            width: 99.6%;
            height: 50%;
            text-align: center;
            display: grid;
            align-items: center;
            border:1px solid black;
            border-bottom: none;
            font-size: 40px;
        }
        .bodyRightBottomDivBottom{
            width: 99.6%;
            height: 50%;
            text-align: center;
            display: grid;
            align-items: center;
            border:1px solid black;
            font-size: 40px;
        }
    </style>
</head>
<body onkeydown="keyDown()" onkeyup="keyUp()" onbeforeunload="close()">
    <div id="titleArea" class="title">
        <b id="title" th:text="'방 번호 : ' + ${metaRoom.metaIdx} + '   |   ' + '(스터디)' + ' 방 제목 : ' + ${metaRoom.metaTitle} + ' ( ' + ${metaRoom.metaRecruitingPersonnel} + ' / ' + ${metaRoom.metaPersonnel} + ' )'"></b>
    </div>
    <div class="body">
            <span class="bodyLeft">
                <div class="bodyLeftTop">
                    <div class="bodyLeftTopTop">
                        <div class="bodyLeftTopTopTop">
                            <span id="dateSpan"></span>
                        </div>
                        <div class="bodyLeftTopTopBottom">
                            <div class="bodyLeftTopTopBottomLeft">
                                <span id="meridiemSpan"></span>
                            </div>
                            <div class="bodyLeftTopTopBottomRight">
                                <span id="timeSpan"></span>
                            </div>
                        </div>
                    </div>
                    <div class="bodyLeftTopMid">
                        <div class="bodyLeftTopMid1">
                            <div class="bodyLeftTopMid1Top" id="bodyLeftTopMid1Top">
                                <input class="bodyLeftTopMid1Top1" id="bodyLeftTopMid1Top1" type="button" value="+" onclick="counting('hour', '+')">
                                <input class="bodyLeftTopMid1Top2" id="bodyLeftTopMid1Top2" type="button" value="-" onclick="counting('hour', '-')">
                            </div>
                            <div class="bodyLeftTopMid1Mid">
                                <span class="bodyLeftTopMid1Mid1" id="bodyLeftTopMid1Mid1">00</span>
                            </div>
                            <div class="bodyLeftTopMid1Bottom" id="bodyLeftTopMid1Bottom">
                                <input class="bodyLeftTopMid1BottomInput" id="bodyLeftTopMid1BottomInput" type="number" onchange="hourChange(this)">
                            </div>
                        </div>
                        <div class="bodyLeftTopMid2">
                            <span>:</span>
                        </div>
                        <div class="bodyLeftTopMid3">
                            <div class="bodyLeftTopMid3Top" id="bodyLeftTopMid3Top">
                                <input class="bodyLeftTopMid3Top1" id="bodyLeftTopMid3Top1" type="button" value="+" onclick="counting('minute','+')">
                                <input class="bodyLeftTopMid3Top2" id="bodyLeftTopMid3Top2" type="button" value="-" onclick="counting('minute','-')">
                            </div>
                            <div class="bodyLeftTopMid3Mid">
                                <span class="bodyLeftTopMid3Mid1" id="bodyLeftTopMid3Mid1">00</span>
                            </div>
                            <div class="bodyLeftTopMid3Bottom" id="bodyLeftTopMid3Bottom">
                                <input class="bodyLeftTopMid3BottomInput" id="bodyLeftTopMid3BottomInput" type="number" onchange="minuteChange(this)">
                            </div>
                        </div>
                        <div class="bodyLeftTopMid4">
                            <span>:</span>
                        </div>
                        <div class="bodyLeftTopMid5">
                            <div class="bodyLeftTopMid5Top" id="bodyLeftTopMid5Top">
                                <input class="bodyLeftTopMid5Top1" id="bodyLeftTopMid5Top1" type="button" value="+" onclick="counting('second', '+')">
                                <input class="bodyLeftTopMid5Top2" id="bodyLeftTopMid5Top2" type="button" value="-" onclick="counting('second', '-')">
                            </div>
                            <div class="bodyLeftTopMid5Mid">
                                <span class="bodyLeftTopMid5Mid1" id="bodyLeftTopMid5Mid1">00</span>
                            </div>
                            <div class="bodyLeftTopMid5Bottom" id="bodyLeftTopMid5Bottom">
                                <input class="bodyLeftTopMid5BottomInput" id="bodyLeftTopMid5BottomInput" type="number" onchange="secondChange(this)">
                            </div>
                        </div>
                    </div>
                    <div class="bodyLeftTopBottom">
                        <div class="bodyLeftTopBottomTop" id="startButton" onclick="startTimer();">
                            <span class="bodyLeftTopBottomTopSpan" id="startButtonText">START</span>
                        </div>
                        <div class="bodyLeftTopBottomMid" id="stopButton" onclick="stopTimer();">
                            <span class="bodyLeftTopBottomMidSpan" id="stopButtonText">STOP</span>
                        </div>
                        <div class="bodyLeftTopBottomBottom">
                            <span class="bodyLeftTopBottomBottomLeft" id="timerButton" onclick="timerClick('0');">타이머</span>
                            <span class="bodyLeftTopBottomBottomRight" id="stopWatchButton" onclick="timerClick('1');">스톱워치</span>
                        </div>
                    </div>
                </div>
                <div class="bodyLeftMid">
                    <input type="hidden" value="캔버스">
                    <canvas class="bodyLeftMidCanvas" id="canvas"></canvas>
                </div>
                <div class="bodyLeftBottom">
                    <input type="hidden" value="접속자">
                </div>
            </span>
        <span class="bodyRight">
            <div class="bodyRightTop">
                <div class="bodyRightTopTop">
                    <span>CheckList</span>
                </div>
                <div class="bodyRightTopBottom">
                    <!-- 여기서부터 리스트로 돌리면 됨 -->
                    <div class="bodyRightTopBottomDiv">
                        <div class="bodyRightTopBottomDivLeft">
                            <div class="bodyRightTopBottomDivLeftLeft">
                                <input class="bodyRightTopBottomDivLeftLeftClick" style="height: 100%; width: 100%;" type="checkbox">
                            </div>
                            <div class="bodyRightTopBottomDivLeftRight">
                                <span>체크리스트1</span>
                            </div>
                        </div>
                        <div class="bodyRightTopBottomDivRight">
                            <div class="bodyRightTopBottomDivRightDiv">
                                <input  class="bodyRightTopBottomDivRightDiv1" type="button" value="삭제">
                                <input  class="bodyRightTopBottomDivRightDiv2" type="button" value="수정">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bodyRightBottom">
                <input type="hidden" value="디데이">
                <div class="bodyRightBottomDiv">
                    <div class="bodyRightBottomDivTop">
                        <span>D-DAY</span>
                    </div>
                    <div class="bodyRightBottomDivBottom">
                        <span>"수능"</span>
                    </div>
                </div>
            </div>
        </span>
    </div>
<!----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <!-- SockJS 사용을 위한 js를 추가 -->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <!-- Stomp 사용을 위한 js를 추가 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
    <!-- Ajax 사용을 위한 js를 추가 -->
    <script src="/js/httpRequest.js"></script>

    <script th:inline="javascript">
        var metaIdx = [[${metaRoom.metaIdx}]]; // 방 번호
        var metaTitle = [[${metaRoom.metaTitle}]]; // 방 제목
        var metaRecruitingPersonnel = [[${metaRoom.metaRecruitingPersonnel}]]; // 참가중인 인원
        var metaPersonnel = [[${metaRoom.metaPersonnel}]]; // 모집인원
        var nickname = [[${nickImage.nickname}]]; // 로그인 유저의 닉네임
        var profileImage = [[${nickImage.profileImage}]]; // 로그인 유저의 프로필 사진

        // 1. SockJS를 생성한다. (StompWebSocketConfig에서 설정한 Endpoint와 동일하게 맞춰준다.)
        var sockJs = new SockJS("/ws/meta");
        // 2. 생성된 SockJS를 Stomp에 전달한다.
        var stomp = Stomp.over(sockJs);

        // 3. connect가 이뤄지면 실행한다.
        stomp.connect({}, function () {
            // connect가 이뤄지면 콘솔에 로그를 찍는다.
            console.log("STOMP Connection");

            // 5. subscribe(path, callback)으로 메세지를 받을 수 있다.
            //    StompChatController에서 SimpMessagingTemplate를 통해 전달한 DTO를 여기서 콜백 메소드 파라미터로 전달 받는다.
            stomp.subscribe("/sub/meta/oneRoom/" + metaIdx, function (chat) {
                // 6. JSON.parse(변환 대상) - JSON 문자열을 JavaScript 값이나 객체로 변환한다.
                //    JSON형식으로 넘어온 DTO를 JavaScript형식으로 변환한다.
                var content = JSON.parse(chat.body);
                // 6-1. 변환된 DTO를 사용하기 편하게 각각 변수에 나눠놓는다.
                var writer = content.writer; // 작성자
                var participant = content.participant; // 참가자 닉네임
                var profileImage = content.profileImage; // 참가자 프로필 사진
                var exit = content.exit; // 퇴장자 닉네임
                var recruitingPersonnel = content.metaRecruitingPersonnel; // 참가중인 인원

                // 작성자가 로그인 유저와 같은 경우 (본인)
                if ( writer === nickname ) {

                // 작성자가 로그인 유저와 다른 경우 (타 유저)
                } else {
                    // 참가중인 인원이 바뀌는 경우 - 본인이 방에 들어올 경우에는 위에서 th:text로 참가한 방의 정보들이 다 작성되기에 참가자가 본인이 아닌 경우에만 실시간으로 참가중인 인원이 바뀌어 새로 작성되도록 만든다.
                    if ( recruitingPersonnel != null ) {
                        var title = document.getElementById("title"); // 방 정보 id
                        title.remove(); // 위에서 가져온 id를 이용하여 해당 방 정보를 삭제한다.

                        var titleArea = document.getElementById("titleArea"); // 방 정보가 작성될 구역
                        var ptr = ""; // 방 정보 코드가 작성될 변수

                        // 방 정보 코드를 작성한다.
                        prt = '<b id="title">';
                        prt += '방 번호 : ';
                        prt += metaIdx;
                        prt += '   |    (스터디) 방 제목 : ';
                        prt += metaTitle;
                        prt += ' ( '
                        prt += recruitingPersonnel;
                        prt += ' / ';
                        prt += metaPersonnel;
                        prt += ' )';
                        prt += '</b>';
                        // 작성된 방 정보 코드를 참가자 구역에 올린다.
                        // insertAdjacentHTML( position, html ) - position에 따른 위치에 html 요소를 추가 한다.
                        // position에는 총 4가지의 옵션이 있다.
                        // 1. beforebegin : 타켓 요소 전(형제 요소)에 생성한다. - 시작 태그의 앞 (형제 요소)
                        // 2. afterbegin : 타켓 요소 다음(자식 요소)에 생성한다. - 시작 태그의 뒤 (자식 요소)
                        // 3. beforeend : 타켓 요소 '끝나는 태그' 바로 직전(자식 요소)에 요소를 생성한다. - 종료 태그 앞 (자식 요소)
                        // 4. afterend : 타켓 요소의 '끝나는 태그' 바로 다음(형제 요소)에 요소를 생성한다. - 종료 태그 뒤 (형제 요소)
                        titleArea.insertAdjacentHTML("afterbegin", prt);
                    }

                    // 새로 들어온 참가자가 있는 경우 - 본인이 방에 들어올 경우에는 위에서 th:each로 참가자가 모두 작성되기에 참가자가 본인이 아닌 경우에만 실시간으로 참가자 구역에 추가 작성되도록 만든다.
                    if ( participant != null ) {
                        var menuBar = document.getElementById("menuBar"); // 참가자가 작성될 구역
                        var mtr = ""; // 참가자 코드가 작성될 변수

                        // 참가자가 새로 들어온게 아닌 새로고침한 경우 - 이전에 작성되있던 참가자 코드랑 중복되지 않게 먼저 삭제한다.
                        var ptr = document.getElementById(writer); // 이전에 작성되있던 참가자 id
                        // 이전에 작성되있던 참가자 코드가 있을 경우
                        if ( ptr != null ) {
                            ptr.remove(); // 위에서 가져온 id를 이용하여 해당 참가자를 삭제한다.
                        }

                        // 참가자 코드를 작성한다.
                        mtr = '<div id="' + writer + '" style="border: 1px solid black; box-sizing: border-box; width: 10%; height: 100%; float: left;">';
                        mtr += '<img src="/imagePath/' + profileImage + '" style="width: 50%; height: 100%; float: left;">';
                        mtr += '<b>' + writer + '</b>';
                        // 작성된 참가자 코드를 참가자 구역에 올린다.
                        // insertAdjacentHTML( position, html ) - position에 따른 위치에 html 요소를 추가 한다.
                        // position에는 총 4가지의 옵션이 있다.
                        // 1. beforebegin : 타켓 요소 전(형제 요소)에 생성한다. - 시작 태그의 앞 (형제 요소)
                        // 2. afterbegin : 타켓 요소 다음(자식 요소)에 생성한다. - 시작 태그의 뒤 (자식 요소)
                        // 3. beforeend : 타켓 요소 '끝나는 태그' 바로 직전(자식 요소)에 요소를 생성한다. - 종료 태그 앞 (자식 요소)
                        // 4. afterend : 타켓 요소의 '끝나는 태그' 바로 다음(형제 요소)에 요소를 생성한다. - 종료 태그 뒤 (형제 요소)
                        menuBar.insertAdjacentHTML("afterbegin", mtr);
                    }

                    // 해당 방을 나가는 경우 - 본인이 방을 나갈 경우에는 본인은 나가고 없으므로 퇴장자가 본인이 아닌 경우에만 실시간으로 참가자 구역에서 삭제되도록 만든다.
                    if ( exit != null ) {
                        var mtr = document.getElementById(writer); // 참가자 id
                        mtr.remove(); // 위에서 가져온 id를 이용하여 해당 참가자를 삭제한다.
                    }
                }
            });

            // 4번이 5번보다 아래에 위치한 이유 - 위에 있을경우 간혹 4번에서 전송한 메세지를 제대로 전달받지 못하는 경우가 존재한다.
            // 4. send(path, header, message)로 메세지를 보낸다. (입장할때 딱 한번만 전달한다.)
            //    JSON.stringify({json형식}) - JavaScript 값이나 객체를 JSON 문자열로 변환한다.
            //    여기서 보낸 메세지를 StompChatController에 @MessageMapping이 DTO를 통해 받는다.
            stomp.send('/pub/meta/oneRoom/enter', {}, JSON.stringify({metaIdx : metaIdx, writer : nickname, profileImage : profileImage, metaRecruitingPersonnel : metaRecruitingPersonnel}));
        });

        // 방 나가기 (Ajax 사용) - onbeforeunload를 사용하기 위해선 반드시 Ajax를 사용해야 한다.
        // onbeforeunload (body 태그에 작성) - 탭 닫기, 윈도우 닫기, 뒤로가기, 나가기 버튼 등 해당 페이지를 벗어나는 기능을 실행할 경우 아래 메소드를 항상 실행한다.
        function close() {
            // send(path, header, message)로 메세지를 보낸다. (퇴장할때 딱 한번만 전달한다.)
            // JSON.stringify({json형식}) - JavaScript 값이나 객체를 JSON 문자열로 변환한다.
            // 여기서 보낸 메세지를 StompChatController에 @MessageMapping이 DTO를 통해 받는다.
            stomp.send('/pub/meta/oneRoom/exit', {}, JSON.stringify({metaIdx : metaIdx, writer : nickname, metaRecruitingPersonnel : metaRecruitingPersonnel}));

            var url = "/meta/exit";
            var param = "metaIdx=" + metaIdx;
            sendRequest(url, param, resultClose, "get");
        }
        // 방 나가기 콜백 메소드
        function resultClose() {
            if ( xhr.readyState == 4 && xhr.status == 200 ) {
                // 방에서 나가면 해당 페이지가 아예 사라져 그 뒤 일을 수행하지 못하므로 콜백 메소드를 따로 사용할 일은 없다.
            }
        }
    </script>

    <script>
        let isWatch = false; //타이머로 설정되었는지 스톱워치로 설정되었는지 확인
        let hourPlus = document.getElementById("bodyLeftTopMid1Top1"); //타이머에서 시간을 증가시키는 버튼
        let hourMinus = document.getElementById("bodyLeftTopMid1Top2"); //타이머에서 시간을 감소시키는 버튼
        let hourCountDiv = document.getElementById("bodyLeftTopMid1Mid1"); // 시계에 숫자를 가지고있는 span 태그 변수
        let hourCount = 0; // 실제 시간을 정할 정수타입 변수
        let hourInputCount = document.getElementById("bodyLeftTopMid1BottomInput"); // 타이머에 직접 시간을 입력할 수 있는 input 태그 변수
        let minutePlus = document.getElementById("bodyLeftTopMid3Top1"); //타이머에서 분을 증가시키는 버튼
        let minuteMinus = document.getElementById("bodyLeftTopMid3Top2"); //타이머에서 분을 감소시키는 버튼
        let minuteCountDiv = document.getElementById("bodyLeftTopMid3Mid1"); // 시계에 분을 가지고있는 span 태그 변수
        let minuteCount = 0; // 실제 분을 정할 정수타입 변수
        let minuteInputCount = document.getElementById("bodyLeftTopMid3BottomInput"); // 타이머에 직접 분을 입력할 수 있는 input 태그 변수
        let secondPlus = document.getElementById("bodyLeftTopMid5Top1"); //타이머에서 초를 증가시키는 버튼
        let secondMinus = document.getElementById("bodyLeftTopMid5Top2"); //타이머에서 초를 감소시키는 버튼
        let secondCountDiv = document.getElementById("bodyLeftTopMid5Mid1"); // 시계에 초를 가지고있는 span 태그 변수
        let secondCount = 0; // 실제 초를 정할 정수타입 변수
        let secondInputCount = document.getElementById("bodyLeftTopMid5BottomInput"); // 타이머에 직접 초를 입력할 수 있는 input 태그 변수
        let hourCountText = ""; // 시간을 두자리로 바꾼이후 문자열로 입력하기위한 변수
        let minuteCountText = ""; // 분을 두자리로 바꾼이후 문자열로 입력하기위한 변수
        let secondCountText = ""; // 초를 두자리로 바꾼이후 문자열로 입력하기위한 변수
        let topButton1 = document.getElementById("bodyLeftTopMid1Top"); //타이머에서 시간을 증가, 감소시키는 버튼들을 감싼 div 태그
        let topButton2 = document.getElementById("bodyLeftTopMid3Top"); //타이머에서 분을 증가, 감소시키는 버튼들을 감싼 div 태그
        let topButton3 = document.getElementById("bodyLeftTopMid5Top"); //타이머에서 초를 증가, 감소시키는 버튼들을 감싼 div 태그
        let bottomButton1 = document.getElementById("bodyLeftTopMid1Bottom"); //타이머에서 시간을 작성하는 input 태그
        let bottomButton2 = document.getElementById("bodyLeftTopMid3Bottom"); //타이머에서 분을 작성하는 input 태그
        let bottomButton3 = document.getElementById("bodyLeftTopMid5Bottom"); //타이머에서 초를 작성하는 input 태그
        const TIME_ZONE = 3240 * 10000; // 현재 시간을 설정하는 변수
        const joinTime = new Date().toTimeString().split(' ')[0]; // 유저가 접속한 시간을 저장하기위한 변수
        let isStopWatch = false; // 유저가 스탑워치를 눌렀는지 확인하는 변수
        let isTimer = false; // 유저가 타이머를 눌렀는지 확인하는 변수
        let intervalTimer = null;  // 유저가 시작버튼을 눌렀을때 스레드를 사용하기위한 변수
        let isRunning = false; // 시작버튼이 눌렸는지 확인하는 변수
        let isStop = false; //스탑 버튼이 눌렸는지 확인하는 변수
        let startButton = document.getElementById("startButton"); //시작 버튼 변수
        let startButtonText = document.getElementById("startButtonText");//시작 버튼 텍스트 변수
        let stopButton = document.getElementById("stopButton"); //정지 버튼 변수
        let stopButtonText = document.getElementById("stopButtonText");//정지 버튼 텍스트 변수
        let timerButton = document.getElementById("timerButton"); //타이머 버튼 변수
        let stopWatchButton = document.getElementById("stopWatchButton"); //스톱워치 버튼 변수


        //왼쪽의 날짜와 시간을 계산해주는 메서드(스레드)
        //작성 방식은 setInterval 메서드안에 파라미터값을 두개 준다.
        //앞의 파라미터는 메서드를 넣어준다.
        //뒤의 파라미터는 스레드가 실행할 시간을 넣어준다.
        //스레드가 실행할 시간 타입은 1/1000초로 지정되어있다.
        //1초 마다 실행하기 위해 1000을 넣어주었다.
        setInterval(function(){
            //date 변수에 지금의 시간을 불러온다.
            let date = new Date();
            //today 변수에 지금의 시간을 타임존의 정보에 맞게 가공한 이후 보기 편하도록 dateFormat 을 설정해서 보여준다.
            let today = new Date(+new Date() + TIME_ZONE).toISOString().split('T')[0];
            //dateSpan 의 id를 가진 태그의 값으로 현재 날짜를 저장한다.
            document.getElementById("dateSpan").innerText = today.toString();
            //현재 시간을 dateFormat 으로 시간만 분리해서 저장
            let time = date.toTimeString().split(' ')[0];
            //현재 시간을 formatAMPM 메서드로 오전과 오후로 구분한뒤 12시간 타입으로 구분하게 설정한다.
            let afterTime = formatAMPM(date);
            //현재 시간을 am 과 pm 으로 구분하기 위해서 현재 시간을 가져온다.
            let whatTime = time[0] + time[1];
            //am 과 pm 문자열로 저장하는 변수를 기본 am 으로 초기화 시킨다.
            let meridiem = "AM";
            //만약 whatTime 변수에 값이 12보다 크거나 같다면 오후에 해당하는 pm 으로 변경한다.
            if(whatTime >= 12){
                meridiem = "PM";
            }
            //현재 오전과 오후 상태를 span 태그에 저장한다.
            document.getElementById("meridiemSpan").innerText = meridiem;
            //현재시간을 span 태그에 저장한다.
            document.getElementById("timeSpan").innerText = afterTime;
        }, 1000);

        //현재시간이 오전인지 오후인지 알려주는 메서드
        //파라미터로 현재 시간을 넣어주어야 한다.
        function formatAMPM(date) {
            //시간 변수에 date.getHours() 메서드로 시간만 따로 분리해서 저장한다.
            let hours = date.getHours();
            //시간을 12로 나눈 나머지 값을 변수에 저장한다.
            let afterHours = (hours % 12);
            //만약 변수값이 10 보다 작다면 두자리 숫자로 만들기 위해서 앞에 0을 붙여준다.
            if(afterHours < 10){
                afterHours = "0" + afterHours;
            }
            //분 변수에 date.getMinutes() 메서드로 분만 따로 분리해서 저장한다.
            let minutes = date.getMinutes();
            //계산된 시간과 계산된 분을 타입에 맞게 더한이후 값을 반환해준다.
            return afterHours + ':' + minutes.toString().padStart(2, '0');
        }

        //시간을 증가,감소 시키는 메서드
        //숫자를 입력하는 인풋태그 자체를 파라미터로 가져온다.
        function hourChange(v){
            //만약 인풋태그의 값중 첫번째 자리숫자가 0과 같다면 숫자는 0으로 설정해준다.
            //두자리 숫자를 적어주었을때 앞자리는 숫자가 0이아니라서 가능하다.
            if(v.value.charAt(0) == 0){
                v.value = 0;
            }
            //만약 인풋태그의 값이 99가 넘어간다면 시간은 99를 넘기지 못하게 설정한다.
            //이후 값은 0으로 다시 초기화를 시켜준다.
            if(v.value > 99){
                v.value = 0;
                alert('시간은 99를 넘길 수 없습니다.');
            }
            //만약 인풋태그의 값이 0보다 작다면 시간은 0보다 작을수 없게 설정한다.
            //이후 값은 0으로 다시 초기화를 시켜준다.
            if(v.value < 0){
                v.value = 0;
                alert('시간은 0보다 작을 수 없습니다.');
            }
            //이 조건에 걸리지않는다면 0 ~ 99 까지의 정상적인 값이 들어갔기때문에
            //실제 시간을 카운트하는 변수에 저장한다.
            hourCount = v.value;
            //만약 시간을 카운트하는 변수가 10보다 작다면 한자리숫자 이므로
            //앞에 0을 하나 더 붙인다음 값을 보여주는 텍스트 변수에 저장한다.
            //그렇지 않다면 그값을 그대로 텍스트 변수에 저장한다.
            if(hourCount < 10){
                hourCountText = '0' + hourCount;
            }else{
                hourCountText = hourCount;
            }
            //이후 시간을 보여줄 태그에 값으로 텍스트변수값을 저장한다.
            hourCountDiv.innerHTML = hourCountText;
        }

        //분을 증가,감소 시키는 메서드
        //숫자를 입력하는 인풋태그 자체를 파라미터로 가져온다.
        function minuteChange(v){
            //만약 인풋태그의 값중 첫번째 자리숫자가 0과 같다면 숫자는 0으로 설정해준다.
            //두자리 숫자를 적어주었을때 앞자리는 숫자가 0이아니라서 가능하다.
            if(v.value.charAt(0) == 0){
                v.value = 0;
            }
            //만약 인풋태그의 값이 59가 넘어간다면 분은 59를 넘기지 못하게 설정한다.
            //이후 값은 0으로 다시 초기화를 시켜준다.
            if(v.value > 59){
                v.value = 0;
                alert('분은 59를 넘길 수 없습니다.');
            }
            //만약 인풋태그의 값이 0보다 작다면 분은 0보다 작을수 없게 설정한다.
            //이후 값은 0으로 다시 초기화를 시켜준다.
            if(v.value < 0){
                v.value = 0;
                alert('분은 0보다 작을 수 없습니다.');
            }
            //이 조건에 걸리지않는다면 0 ~ 59 까지의 정상적인 값이 들어갔기때문에
            //실제 분을 카운트하는 변수에 저장한다.
            minuteCount = v.value;
            //만약 분을 카운트하는 변수가 10보다 작다면 한자리숫자 이므로
            //앞에 0을 하나 더 붙인다음 값을 보여주는 텍스트 변수에 저장한다.
            //그렇지 않다면 그값을 그대로 텍스트 변수에 저장한다.
            if(minuteCount < 10){
                minuteCountText = '0' + minuteCount;
            }else{
                minuteCountText = minuteCount;
            }
            //이후 분을 보여줄 태그에 값으로 텍스트변수값을 저장한다.
            minuteCountDiv.innerHTML = minuteCountText;
        }

        //초를 증가, 감소시키는 메서드
        //숫자를 입력하는 인풋태그 자체를 파라미터로 가져온다.
        function secondChange(v){
            //만약 인풋태그의 값중 첫번째 자리숫자가 0과 같다면 숫자는 0으로 설정해준다.
            //두자리 숫자를 적어주었을때 앞자리는 숫자가 0이아니라서 가능하다.
            if(v.value.charAt(0) == 0){
                v.value = 0;
            }
            //만약 인풋태그의 값이 59가 넘어간다면 초는 59를 넘기지 못하게 설정한다.
            //이후 값은 0으로 다시 초기화를 시켜준다.
            if(v.value > 59){
                v.value = 0;
                alert('초는 59를 넘길 수 없습니다.');
            }
            //만약 인풋태그의 값이 0보다 작다면 초는 0보다 작을수 없게 설정한다.
            //이후 값은 0으로 다시 초기화를 시켜준다.
            if(v.value < 0){
                v.value = 0;
                alert('초는 0보다 작을 수 없습니다.');
            }
            //이 조건에 걸리지않는다면 0 ~ 59 까지의 정상적인 값이 들어갔기때문에
            //실제 초를 카운트하는 변수에 저장한다.
            secondCount = v.value;
            //만약 초를 카운트하는 변수가 10보다 작다면 한자리숫자 이므로
            //앞에 0을 하나 더 붙인다음 값을 보여주는 텍스트 변수에 저장한다.
            //그렇지 않다면 그값을 그대로 텍스트 변수에 저장한다.
            if(secondCount < 10){
                secondCountText = '0' + secondCount;
            }else{
                secondCountText = secondCount;
            }
            //이후 초를 보여줄 태그에 값으로 텍스트변수값을 저장한다.
            secondCountDiv.innerHTML = secondCountText;
        }

        //타이머의 시간을 설정할때의 기본값들을 정하는 메서드
        //파라미터로 t와 v를 받아온다.
        //t : 어떤 버튼을 눌렀는지 확인하기위해 'hour' 'minute' 'second' 를 파라미터로 가져온다.
        //v : 어떤 버튼이 눌렸는지 확인하기위해 '+' 혹은 '-' 를 파라미터로 가져온다.
        function counting(t, v){
            //어떤 버튼이 눌렸는지 t의 타입으로 구분한다.
            switch(t){
                //타입이 'hour' 버튼이 눌렸다면 아래 if 조건으로 들어간다.
                case 'hour':
                    //만약 타입이 '+' 라면 아래 if 조건으로 들어간다.
                    //만약 타입이 '-' 라면 아래 else if 조건으로 들어간다.
                    //else 로 잡아도 되지면 확실한 조건을 하기위해서 else if 문으로 작성했다.
                    if(v == '+'){
                        //만약 시간 카운트 변수가 99보다 크거나 같다면 alert 창으로 경고한 뒤 값이 변할 수 없도록 설정한다.
                        //그렇지 않다면 시간 카운트 변수를 하나 증가시킨다.
                        if(hourCount >= 99){
                            alert('시간은 99시간을 넘길 수 없습니다.');
                        }else{
                            hourCount++;
                        }
                    }else if(v == '-'){
                        //만약 시간 카운트 변수가 0보다 작거나 같다면 alert 창으로 경고한 뒤 값이 변할 수 없도록 설정한다.
                        //그렇지 않다면 시간 카운트 변수를 하나 감소시킨다.
                        if(hourCount <= 0){
                            alert('시간은 0보다 적을 수 없습니다.');
                        }else{
                            hourCount--;
                        }
                    }
                    //break 로 아래 case 구문실행을 방지한다.
                    break;
                //타입이 'minute' 버튼이 눌렸다면 아래 if 조건으로 들어간다.
                case 'minute':
                    //만약 타입이 '+' 라면 아래 if 조건으로 들어간다.
                    //만약 타입이 '-' 라면 아래 else if 조건으로 들어간다.
                    //else 로 잡아도 되지면 확실한 조건을 하기위해서 else if 문으로 작성했다.
                    if(v == '+'){
                        //만약 분 카운트가 59보다 크거나 같다면 시간 카운트를 하나 증가시키기 위해서 다음 if 조건으로 들어간다.
                        //그렇지 않다면 분 카운트 변수를 하나 증가시킨다.
                        if(minuteCount >= 59){
                            //만약 시간 카운트 변수가 99보다 크거나 같다면 alert 창으로 경고한 뒤 값이 변할 수 없도록 설정한다.
                            //그렇지 않다면 시간 카운트 변수를 하나 증가시킨다.
                            //그리고 분 카운트 변수는 0으로 초기화 한다.
                            //시간 카운트가 올라갔기 때문에 반드시 분 카운트 변수는 0으로 초기화를 시켜줘야 한다.
                            if(hourCount >= 99){
                                alert('시간은 100시간을 넘길 수 없습니다.');
                            }else{
                                hourCount++;
                                minuteCount = 0;
                            }
                        }else{
                            minuteCount++;
                        }
                    }else if(v == '-'){
                        //만약 분 카운트가 0보다 작거나 같다면 시간 카운트를 하나 감소시키기 위해서 다음 if 조건으로 들어간다.
                        //그렇지 않다면 분 카운트 변수를 하나 감소시킨다.
                        if(minuteCount <= 0){
                            //만약 시간 카운트 변수가 0보다 작거나 같다면 alert 창으로 경고한 뒤 값이 변할 수 없도록 설정한다.
                            //그렇지 않다면 시간 카운트 변수를 하나 감소시킨다.
                            //그리고 분 카운트 변수는 59로 초기화 한다.
                            //시간 카운트가 내려갔기 때문에 반드시 분 카운트 변수는 59으로 초기화를 시켜줘야 한다.
                            if(hourCount <= 0){
                                alert('시간은 0보다 적을 수 없습니다.');
                            }else{
                                hourCount--;
                                minuteCount = 59;
                            }
                        }else{
                            minuteCount--;
                        }
                    }
                    //break 로 아래 case 구문실행을 방지한다.
                    break;
                //타입이 'second' 버튼이 눌렸다면 아래 if 조건으로 들어간다.
                case 'second':
                    //만약 타입이 '+' 라면 아래 if 조건으로 들어간다.
                    //만약 타입이 '-' 라면 아래 else if 조건으로 들어간다.
                    //else 로 잡아도 되지면 확실한 조건을 하기위해서 else if 문으로 작성했다.
                    if(v == '+'){
                        //만약 초 카운트가 59보다 크거나 같다면 분 카운트를 하나 증가시키기 위해서 다음 if 조건으로 들어간다.
                        //그렇지 않다면 초 카운트 변수를 하나 증가시킨다.
                        if(secondCount >= 59){
                            //만약 분 카운트가 59보다 크거나 같다면 시간 카운트를 하나 증가시키기 위해서 다음 if 조건으로 들어간다.
                            //그렇지 않다면 분 카운트 변수를 하나 증가시킨다.
                            //그리고 초 카운트 변수는 0으로 초기화 한다.
                            //분 카운트가 올라갔기 때문에 반드시 초 카운트 변수는 0으로 초기화를 시켜줘야 한다.
                            if(minuteCount >= 59){
                                //만약 시간 카운트 변수가 99보다 크거나 같다면 alert 창으로 경고한 뒤 값이 변할 수 없도록 설정한다.
                                //그렇지 않다면 시간 카운트 변수를 하나 증가시킨다.
                                //그리고 분 카운트 변수와 초 카운트 변수는 0으로 초기화 한다.
                                //분 카운트가 올라가서 시간 카운트가 올라갔기 때문에 반드시 분 카운트 변수와 초 카운트 변수는 0으로 초기화를 시켜줘야 한다.
                                if(hourCount >= 99){
                                    alert('시간은 99:99:99 위로 올라갈 수 없습니다.');
                                }else{
                                    hourCount++;
                                    minuteCount = 0;
                                    secondCount = 0;
                                }
                            }else{
                                minuteCount++;
                                secondCount = 0;
                            }
                        }else{
                            secondCount++;
                        }
                    }else if(v == '-'){
                        //만약 초 카운트가 0보다 작거나 같다면 분 카운트를 하나 감소시키기 위해서 다음 if 조건으로 들어간다.
                        //그렇지 않다면 초 카운트 변수를 하나 감소시킨다.
                        if(secondCount <= 0){
                            //만약 분 카운트가 0보다 작거나 같다면 시간 카운트를 하나 감소시키기 위해서 다음 if 조건으로 들어간다.
                            //그렇지 않다면 분 카운트 변수를 하나 감소시킨다.
                            if(minuteCount <= 0){
                                //만약 시간 카운트 변수가 0보다 작거나 같다면 alert 창으로 경고한 뒤 값이 변할 수 없도록 설정한다.
                                //그렇지 않다면 시간 카운트 변수를 하나 감소시킨다.
                                //그리고 분 카운트 변수와 초 카운트 변수는 59로 초기화 한다.
                                //분 카운트가 내려가서 시간 카운트가 내려갔기 때문에 반드시 분 카운트 변수와 초 카운트 변수는 59으로 초기화를 시켜줘야 한다.
                                if(hourCount <= 0){
                                    alert('시간은 00:00:00 아래로 내려갈 수 없습니다.');
                                }else{
                                    hourCount--;
                                    minuteCount = 59;
                                    secondCount = 59;
                                }
                            }else{
                                minuteCount--;
                                secondCount = 59;
                            }
                        }else{
                            secondCount--;
                        }
                    }
                    //break 로 아래 case 구문실행을 방지한다.
                    break;
            }
            //만약 시간 카운트가 10보다 작다면 앞의 자리에 0을 붙여준 이후 텍스트 변수에 시간 카운트를 저장한다.
            //그렇지 않다면 텍스트 변수에 시간 카운트를 저장한다.
            if(hourCount < 10){
                hourCountText = '0' + hourCount;
            }else{
                hourCountText = hourCount;
            }

            //만약 분 카운트가 10보다 작다면 앞의 자리에 0을 붙여준 이후 텍스트 변수에 분 카운트를 저장한다.
            //그렇지 않다면 텍스트 변수에 분 카운트를 저장한다.
            if(minuteCount < 10){
                minuteCountText = '0' + minuteCount;
            }else{
                minuteCountText = minuteCount;
            }

            //만약 초 카운트가 10보다 작다면 앞의 자리에 0을 붙여준 이후 텍스트 변수에 초 카운트를 저장한다.
            //그렇지 않다면 텍스트 변수에 초 카운트를 저장한다.
            if(secondCount < 10){
                secondCountText = '0' + secondCount;
            }else{
                secondCountText = secondCount;
            }

            //이후 시간을 보여줄 태그에 값으로 텍스트변수값을 저장한다.
            hourCountDiv.innerHTML = hourCountText;
            //이후 분을 보여줄 태그에 값으로 텍스트변수값을 저장한다.
            minuteCountDiv.innerHTML = minuteCountText;
            //이후 초를 보여줄 태그에 값으로 텍스트변수값을 저장한다.
            secondCountDiv.innerHTML = secondCountText;
            //이후 시간을 입력하는 인풋 태그에 텍스트변수값을 저장한다.
            //시간을 버튼으로 변경해도 인풋 태그의 값도 같이 변경이되게 설정한다.
            hourInputCount.value = hourCount;
            //이후 분을 입력하는 인풋 태그에 텍스트변수값을 저장한다.
            //분을 버튼으로 변경해도 인풋 태그의 값도 같이 변경이되게 설정한다.
            minuteInputCount.value = minuteCount;
            //이후 초를 입력하는 인풋 태그에 텍스트변수값을 저장한다.
            //초를 버튼으로 변경해도 인풋 태그의 값도 같이 변경이되게 설정한다.
            secondInputCount.value = secondCount;
        }

        //타이머 스톱워치 설정
        function timerClick(e){
            switch(e){
                //파라미터가 0이면 타이머를 설정할 수 있게 해준다.
                case '0':
                    //타이머
                    //타이머에서 시간을 증가, 감소시키는 버튼들을 감싼 div 태그를 눈에 보이게 설정한다.
                    topButton1.style.visibility = "visible";
                    //타이머에서 시간을 작성하는 input 태그를 눈에 보이게 설정한다.
                    bottomButton1.style.visibility = "visible";
                    //타이머에서 분을 증가, 감소시키는 버튼들을 감싼 div 태그를 눈에 보이게 설정한다.
                    topButton2.style.visibility = "visible";
                    //타이머에서 분을 작성하는 input 태그를 눈에 보이게 설정한다.
                    bottomButton2.style.visibility = "visible";
                    //타이머에서 초를 증가, 감소시키는 버튼들을 감싼 div 태그를 눈에 보이게 설정한다.
                    topButton3.style.visibility = "visible";
                    //타이머에서 초를 작성하는 input 태그를 눈에 보이게 설정한다.
                    bottomButton3.style.visibility = "visible";
                    //시간을 보여주는 모든 태그들을 00:00:00 으로 초기화한다.
                    hourCountDiv.innerHTML = '00';
                    minuteCountDiv.innerHTML = '00';
                    secondCountDiv.innerHTML = '00';
                    //실제 시간을 카운트 하는 모든 변수들을 0으로 초기화한다.
                    hourCount = 0;
                    minuteCount = 0;
                    secondCount = 0;
                    //시간을 작성 하는 모든 input 태그들을 0으로 초기화한다.
                    hourInputCount.value = 0;
                    minuteInputCount.value = 0;
                    secondInputCount.value = 0;
                    //현재 누른 버튼이 타이머인것을 설정하기위해서
                    //isWatch 를 false 값으로 지정한다.
                    isWatch = false;
                    //다음 case 문이 실행되지 않게 break 를 작성한다.
                    break;
                //파라미터가 1이면 스톱워치를 설정할 수 있게 해준다.
                case '1':
                    //스톱워치
                    //타이머에서 시간을 증가, 감소시키는 버튼들을 감싼 div 태그를 눈에 보이지 않게 설정한다.
                    topButton1.style.visibility = "hidden";
                    //타이머에서 시간을 작성하는 input 태그를 눈에 보이지 않게 설정한다.
                    bottomButton1.style.visibility = "hidden";
                    //타이머에서 분을 증가, 감소시키는 버튼들을 감싼 div 태그를 눈에 보이지 않게 설정한다.
                    topButton2.style.visibility = "hidden";
                    //타이머에서 분을 작성하는 input 태그를 눈에 보이지 않게 설정한다.
                    bottomButton2.style.visibility = "hidden";
                    //타이머에서 초를 증가, 감소시키는 버튼들을 감싼 div 태그를 눈에 보이지 않게 설정한다.
                    topButton3.style.visibility = "hidden";
                    //타이머에서 초를 작성하는 input 태그를 눈에 보이지 않게 설정한다.
                    bottomButton3.style.visibility = "hidden";
                    //시간을 보여주는 모든 태그들을 00:00:00 으로 초기화한다.
                    hourCountDiv.innerHTML = '00';
                    minuteCountDiv.innerHTML = '00';
                    secondCountDiv.innerHTML = '00';
                    //실제 시간을 카운트 하는 모든 변수들을 0으로 초기화한다.
                    hourCount = 0;
                    minuteCount = 0;
                    secondCount = 0;
                    //시간을 작성 하는 모든 input 태그들을 0으로 초기화한다.
                    hourInputCount.value = 0;
                    minuteInputCount.value = 0;
                    secondInputCount.value = 0;
                    //현재 누른 버튼이 스톱워치인것을 설정하기위해서
                    //isWatch 를 true 값으로 지정한다.
                    isWatch = true;
                    //다음 case 문이 따로 있지는 않지만 혹시 모르니깐 break 를 작성한다.
                    break;
            }
        }

        //스타트 버튼을 눌렀을때 실행될 메서드
        function startTimer(){
            //isRunning 이 true 라면 isRunning 을 false 로 변경한다.
            //이후 스레드를 정시 시킨후에 모든 값들을 초기화 시킨다.
            if(isRunning == true || isStop == true){
                isRunning = false;
                startButtonText.innerHTML = "START";
                isStop = false;
                stopButtonText.innerHTML = "STOP";
                hourCountDiv.innerHTML = '00';
                minuteCountDiv.innerHTML = '00';
                secondCountDiv.innerHTML = '00';
                hourCount = 0;
                minuteCount = 0;
                secondCount = 0;
                hourInputCount.value = 0;
                minuteInputCount.value = 0;
                secondInputCount.value = 0;
                clearInterval(intervalTimer);
                if(isWatch == true){
                    isStopWatch = false;
                }else{
                    isTimer = false;
                    topButton1.style.visibility = "visible";
                    bottomButton1.style.visibility = "visible";
                    topButton2.style.visibility = "visible";
                    bottomButton2.style.visibility = "visible";
                    topButton3.style.visibility = "visible";
                    bottomButton3.style.visibility = "visible";
                }
            }else{
                isRunning = true;
                startButtonText.innerHTML = "RESET";
                topButton1.style.visibility = "hidden";
                bottomButton1.style.visibility = "hidden";
                topButton2.style.visibility = "hidden";
                bottomButton2.style.visibility = "hidden";
                topButton3.style.visibility = "hidden";
                bottomButton3.style.visibility = "hidden";
                if(isWatch == false){
                    if(hourCount == 0 && minuteCount == 0 && secondCount == 0){
                        isRunning = false;
                        startButtonText.innerHTML = "START";
                        alert('시간지정안댐');
                        topButton1.style.visibility = "visible";
                        bottomButton1.style.visibility = "visible";
                        topButton2.style.visibility = "visible";
                        bottomButton2.style.visibility = "visible";
                        topButton3.style.visibility = "visible";
                        bottomButton3.style.visibility = "visible";
                    }else{
                        isTimer = true;
                        if(isTimer == true){
                            intervalTimer = setInterval(timer, 1000);
                        }
                    }
                }else{
                    isStopWatch = true;
                    if(isStopWatch == true){
                        intervalTimer = setInterval(stopWatch, 1000);
                    }
                }
            }
        }
        //스탑 버튼을 눌렀을때 실행될 메서드
        function stopTimer(){
            if(isStop == true){
                isStop = false;
                stopButtonText.innerHTML = "STOP";
                isRunning = true;
                if(isWatch == true){
                    isStopWatch = true;
                }else{
                    isTimer = true;
                }
                topButton1.style.visibility = "hidden";
                bottomButton1.style.visibility = "hidden";
                topButton2.style.visibility = "hidden";
                bottomButton2.style.visibility = "hidden";
                topButton3.style.visibility = "hidden";
                bottomButton3.style.visibility = "hidden";
                if(isWatch == false){
                    if(hourCount == 0 && minuteCount == 0 && secondCount == 0){
                        isRunning = false;
                    }else{
                        isTimer = true;
                        if(isTimer == true){
                            intervalTimer = setInterval(timer, 1000);
                        }
                    }
                }else{
                    isStopWatch = true;
                    if(isStopWatch == true){
                        intervalTimer = setInterval(stopWatch, 1000);
                    }
                }
            }else{
                isStop = true;
                stopButtonText.innerHTML = "RESTART";
                isRunning = false;
                if(isWatch == true){
                    isStopWatch = false;
                }else{
                    isWatch = false;
                }
                clearInterval(intervalTimer);
            }
        }

        //타이머 스레드를 돌릴때 안에 들어갈 메서드
        function timer(){
            //만약 isTimer 가 false 라면 저장된 스레드를 삭제시킨다.
            //이건 스레드가 계속해서 실행될때 시간이 종료되면 삭제시키기 위해서 조건을 넣어주었다.
            if(isTimer != true){
                clearInterval(intervalTimer);
            }else{
                //만약 secondCount 가 0이라면 if 조건으로 들어간다.
                if(secondCount <= 0){
                    //만약 minuteCount 가 0이라면 if 조건으로 들어간다.
                    if(minuteCount <= 0){
                        //만약 hourCount 가 0이라면 alert 창으로 시간이 종료된것을 알려준다.
                        //이후 isTimer1을 false 로 변경시켜주어 스레드가 종료되게 설정한다.
                        //그리고 isRunning 을 false 로 변경시켜서 작동이 멈추었다고 알려준다.
                        //그렇지 않다면 시간 카운트를 하나 감소시킨다.
                        //그리고 분 카운트와 초 카운트를 59로 설정한다.
                        if(hourCount <= 0){
                            alert('시간종료');
                            isTimer = false;
                            isRunning = false;
                            //만약 isRunning 이 false 라면 startButtonText 안의 내용을 start 로 변경한다.
                            if(isRunning == false){
                                startButtonText.innerHTML = 'START';
                                //타이머가 종료 되면 다시 눈에 보이게 한다.
                                if(isWatch != true){
                                    topButton1.style.visibility = "visible";
                                    bottomButton1.style.visibility = "visible";
                                    topButton2.style.visibility = "visible";
                                    bottomButton2.style.visibility = "visible";
                                    topButton3.style.visibility = "visible";
                                    bottomButton3.style.visibility = "visible";
                                }
                            }
                        }else{
                            hourCount--;
                            minuteCount = 59;
                            secondCount = 59;
                        }
                    //만약 분 카운트가 0이 아니라면 분 카운트를 하나 감소 시킨다.
                    //그리고 초 카운트를 59로 설정한다.
                    }else{
                        minuteCount--;
                        secondCount = 59;
                    }
                //만약 초 카운트가 0이 아니라면 초 카운트를 하나 감소 시킨다.
                }else{
                    secondCount--;
                }
                //만약 시간 카운트가 10보다 작다면 앞에 0을 붙여준다.
                //이후 시간을 보여주는 텍스트 변수에 저장시켜준다.
                if(hourCount < 10){
                    hourCountText = '0' + hourCount;
                //그렇지 않다면 시간을 보여주는 텍스트변수에 저장시켜준다.
                }else{
                    hourCountText = hourCount;
                }
                //만약 분 카운트가 10보다 작다면 앞에 0을 붙여준다.
                //이후 분을 보여주는 텍스트 변수에 저장시켜준다.
                if(minuteCount < 10){
                    minuteCountText = '0' + minuteCount;
                //그렇지 않다면 분을 보여주는 텍스트변수에 저장시켜준다.
                }else{
                    minuteCountText = minuteCount;
                }
                //만약 초 카운트가 10보다 작다면 앞에 0을 붙여준다.
                //이후 초를 보여주는 텍스트 변수에 저장시켜준다.
                if(secondCount < 10){
                    secondCountText = '0' + secondCount;
                //그렇지 않다면 초를 보여주는 텍스트변수에 저장시켜준다.
                }else{
                    secondCountText = secondCount;
                }
                //시간을 보여주는 변수에 시간 텍스트 변수를 저장시켜준다.
                hourCountDiv.innerHTML = hourCountText;
                //분을 보여주는 변수에 분 텍스트 변수를 저장시켜준다.
                minuteCountDiv.innerHTML = minuteCountText;
                //초를 보여주는 변수에 초 텍스트 변수를 저장시켜준다.
                secondCountDiv.innerHTML = secondCountText;
                                                                                                //근데 이거 나중에 추가안되게 시작 누르면 안보이게 변경해야지
                //시간을 입력하는 변수에 시간 텍스트 변수를 저장시켜준다.
                hourInputCount.value = hourCount;
                //분을 입력하는 변수에 분 텍스트 변수를 저장시켜준다.
                minuteInputCount.value = minuteCount;
                //초를 입력하는 변수에 초 텍스트 변수를 저장시켜준다.
                secondInputCount.value = secondCount;
            }
        }
        //스톱워치 스레드를 돌릴때 안에 들어갈 메서드
        function stopWatch(){
            //만약 isStopWatch 가 false 라면 저장된 스레드를 삭제시킨다.
            //이건 스레드가 계속해서 실행될때 시간이 종료되면 삭제시키기 위해서 조건을 넣어주었다.
            if(isStopWatch != true){
                clearInterval(intervalTimer);
            }else{
                //만약 secondCount 가 59이라면 if 조건으로 들어간다.
                if(secondCount >= 59){
                    //만약 minuteCount 가 0이라면 if 조건으로 들어간다.
                    if(minuteCount >= 59){
                        //만약 hourCount 가 99라면 alert 창으로 시간이 종료된것을 알려준다.
                        //이후 isStopWatch 를 false 로 변경시켜주어 스레드가 종료되게 설정한다.
                        //그리고 isRunning 을 false 로 변경시켜서 작동이 멈추었다고 알려준다.
                        //그렇지 않다면 시간 카운트를 하나 증가시킨다.
                        //그리고 분 카운트와 초 카운트를 0으로 설정한다.
                        if(hourCount >= 99){
                            alert('시간종료');
                            isStopWatch = false;
                            isRunning = false;
                            //만약 isRunning 이 false 라면 startButtonText 안의 내용을 start 로 변경한다.
                            if(isRunning == false){
                                startButtonText.innerHTML = 'START';
                            }
                        }else{
                            hourCount++;
                            minuteCount = 0;
                            secondCount = 0;
                        }
                    //만약 분 카운트가 59보다 크거나 같다면 분 카운트를 하나 증가 시킨다.
                    //그리고 초 카운트를 0으로 설정한다.
                    }else{
                        minuteCount++;
                        secondCount = 0;
                    }
                //만약 초 카운트가 60보다 크거나 같다면 초 카운트를 하나 증가 시킨다.
                }else{
                    secondCount++;
                }
                //만약 시간 카운트가 10보다 작다면 앞에 0을 붙여준다.
                //이후 시간을 보여주는 텍스트 변수에 저장시켜준다.
                if(hourCount < 10){
                    hourCountText = '0' + hourCount;
                //그렇지 않다면 시간을 보여주는 텍스트변수에 저장시켜준다.
                }else{
                    hourCountText = hourCount;
                }
                //만약 분 카운트가 10보다 작다면 앞에 0을 붙여준다.
                //이후 분을 보여주는 텍스트 변수에 저장시켜준다.
                if(minuteCount < 10){
                    minuteCountText = '0' + minuteCount;
                //그렇지 않다면 분을 보여주는 텍스트변수에 저장시켜준다.
                }else{
                    minuteCountText = minuteCount;
                }
                //만약 초 카운트가 10보다 작다면 앞에 0을 붙여준다.
                //이후 초를 보여주는 텍스트 변수에 저장시켜준다.
                if(secondCount < 10){
                    secondCountText = '0' + secondCount;
                //그렇지 않다면 초를 보여주는 텍스트변수에 저장시켜준다.
                }else{
                    secondCountText = secondCount;
                }
                //시간을 보여주는 변수에 시간 텍스트 변수를 저장시켜준다.
                hourCountDiv.innerHTML = hourCountText;
                //분을 보여주는 변수에 분 텍스트 변수를 저장시켜준다.
                minuteCountDiv.innerHTML = minuteCountText;
                //초를 보여주는 변수에 초 텍스트 변수를 저장시켜준다.
                secondCountDiv.innerHTML = secondCountText;
                                                                                                //이거도 나중에 추가안되게 시작 누르면 안보이게 변경해야지
                //시간을 입력하는 변수에 시간 텍스트 변수를 저장시켜준다.
                hourInputCount.value = hourCount;
                //분을 입력하는 변수에 분 텍스트 변수를 저장시켜준다.
                minuteInputCount.value = minuteCount;
                //초를 입력하는 변수에 초 텍스트 변수를 저장시켜준다.
                secondInputCount.value = secondCount;
            }
        }
    </script>

    <script th:inline="javascript">
        let canvas; // 도화지
        let canvasLeft; // 왼쪽 벽
        let canvasTop; // 위쪽 벽
        let canvasRight; // 오른쪽 벽
        let canvasBottom; // 아래쪽 벽
        let context; // 화가
        let imgC = "imgChar2"; // 그림 이름 받는곳

        let dx = 0; // x축 움직임
        let dy = 0; // y축 움직임

        let keycode; // 키보드 키코드

        let imgChar = new Image(); // 캐릭터 1번 동작 이미지
        imgChar.src = "/character/mario.png"; // 캐릭터 1번 동작 이미지 주소
        let imgChar2 = new Image(); // 캐릭터 2번 동작 이미지
        imgChar2.src = "/character/mario2.png"; // 캐릭터 2번 동작 이미지 주소
        let imgBg = new Image(); // 배경 이미지
        imgBg.src = "/map/oneRoom.png"; // 배경 이미지 주소

        let a = document.getElementById("canvas").clientWidth;
        let b = a / 2;
        let c = document.getElementById("canvas").clientHeight;
        d = (c / 6) * 5;

        let x = b, y = d; // 캐릭터 시작 위치 지정
        let w = 20, h = 20; // 캐릭터 크기 지정 (전체 사이즈의 절반만 작성)

        // 윈도우 시작시 가장 먼저 실행되는 메소드
        window.onload = function(e) {
            // canvas id값으로 가져오기
            canvas = document.getElementById("canvas");
            // canvas를 2d로 설정
            context = canvas.getContext("2d");
            // canvas 크기 설정
            setCanvasSize();

            // 캔버스 크기의 절대적 위치
            canvasLeft = 0 + 50; // 왼쪽 벽
            canvasTop = 0 + 50 // 위쪽 벽
            canvasRight = document.getElementById("canvas").clientWidth - 50; // 오른쪽 벽
            canvasBottom = document.getElementById("canvas").clientHeight - 50; // 아래쪽 벽

            // 시작!!
            //runGame();
            // 시작 알람
            alert("스터디룸에 입장하셨습니다");
            // 실행되고있는 AnimationFrame 삭제 - 이 작업을 먼저 안하면 실행중인 AnimationFrame이 제거되지 않고 계속 쌓이게 된다.
            cancelAnimationFrame(runGame);
            // AnimationFrame 실행 (콜백 메소드) - AnimationFrame으로 실행시킬 메소드를 괄호에 넣는다.
            requestAnimationFrame(runGame);
            // 구형 프레임 작동방식 - 그림을 수시로 그려내는 방식으로 로직이 복잡해질시 프레임이 밀려 캐릭터가 버벅거린다.
            // setInterval(runGame);
        }

        // canvas 크기 설정 메소드 (윈도우 크기게 맞게 설정)
        function setCanvasSize() {
            //캔버스의 현재 길이 설정
            canvas.setAttribute("width", document.getElementById("canvas").clientWidth);
            //캔버스의 현재 높이 설정
            canvas.setAttribute("height", document.getElementById("canvas").clientHeight);
        }

        // 시작 메소드
        function runGame() {
            moveAll(); // 캐릭터에 움직임을 주는 메소드
            drawAll(); // canvas 위에 이미지를 그려주는 메소드
        }

        // 캐릭터에 움직임을 주는 메소드
        function moveAll() {
            x += dx;
            y += dy;
        }

        // canvas 위에 이미지를 그려주는 메소드
        function drawAll() {
            // 배경 그리기
            context.drawImage(imgBg, 0, 0, canvas.width, canvas.height);
            // 캐릭터 동작에 따라 바뀌게 만든다.
            if (imgC == imgChar) { // 그림 이름이 캐릭터 1번 동작일 경우
                // 캐릭터 2번 동작을 그려준다.
                context.drawImage(imgChar2, x-w, y-h, w*2, h*2);
                // 그림 이름을 캐릭터 2번 동작으로 바꿔준다.
                imgC = imgChar2;
            } else { // 그림 이름이 캐릭터 2번 동작일 경우
                // 캐릭터 1번 동작을 그려준다.
                context.drawImage(imgChar, x-w, y-h, w*2, h*2);
                // 그림 이름을 캐릭터 1번 동작으로 바꿔준다.
                imgC = imgChar;
            }
        }

        // 키가 눌렸을때 실행되는 메소드 - 움직임 상태
        function keyDown() {
            keycode = event.keyCode; // 키보드 키코드
            switch(keycode) {
                // 왼쪽으로 이동
                case 37:
                    cancelAnimationFrame(runGame); // 실행되고있는 AnimationFrame 삭제
                    requestAnimationFrame(runGame); // AnimationFrame 실행
                    if ( x < canvasLeft ) { // 왼쪽 벽이 나오면 멈춘다.
                        dx = 0;
                        if ( y < canvasTop ) { // 위쪽 벽이 나오면 멈춘다.
                            dy = 0;
                            break;
                        }
                        if ( y > canvasBottom ) { // 아래쪽 벽이 나오면 멈춘다.
                            dy = 0;
                            break;
                        }
                        break;
                    } else { // 왼쪽 벽이 나오기 전까지 움직인다.
                        dx = -5;
                        if ( y < canvasTop ) { // 위쪽 벽이 나오면 멈춘다.
                            dy = 0;
                            break;
                        }
                        if ( y > canvasBottom ) { // 아래쪽 벽이 나오면 멈춘다.
                            dy = 0;
                            break;
                        }
                        break;
                    }
                // 위로 이동
                case 38:
                    cancelAnimationFrame(runGame); // 실행되고있는 AnimationFrame 삭제
                    requestAnimationFrame(runGame); // AnimationFrame 실행
                    if ( y < canvasTop ) { // 위쪽 벽이 나오면 멈춘다.
                        dy = 0;
                        if ( x < canvasLeft ) { // 왼쪽 벽이 나오면 멈춘다.
                            dx = 0;
                            break;
                        }
                        if ( y > canvasRight ) { // 오른쪽 벽이 나오면 멈춘다.
                            dx = 0;
                            break;
                        }
                        break;
                    } else { // 위쪽 벽이 나오기 전까지 움직인다.
                        dy = -5;
                        if ( x < canvasLeft ) { // 왼쪽 벽이 나오면 멈춘다.
                            dx = 0;
                            break;
                        }
                        if ( x > canvasRight ) { // 오른쪽 벽이 나오면 멈춘다.
                            dx = 0;
                            break;
                        }
                        break;
                    }
                // 오른쪽으로 이동
                case 39:
                    cancelAnimationFrame(runGame); // 실행되고있는 AnimationFrame 삭제
                    requestAnimationFrame(runGame); // AnimationFrame 실행
                    if ( x > canvasRight ) { // 오른쪽 벽이 나오면 멈춘다.
                        dx = 0;
                        if ( y < canvasTop ) { // 위쪽 벽이 나오면 멈춘다.
                            dy = 0;
                            break;
                        }
                        if ( y > canvasBottom ) { // 아래쪽 벽이 나오면 멈춘다.
                            dy = 0;
                            break;
                        }
                        break;
                    } else { // 오른쪽 벽이 나오기 전까지 움직인다.
                        dx = 5;
                        if ( y < canvasTop ) { // 위쪽 벽이 나오면 멈춘다.
                            dy = 0;
                            break;
                        }
                        if ( y > canvasBottom ) { // 아래쪽 벽이 나오면 멈춘다.
                            dy = 0;
                            break;
                        }
                        break;
                    }
                // 아래로 이동
                case 40:
                    cancelAnimationFrame(runGame); // 실행되고있는 AnimationFrame 삭제
                    requestAnimationFrame(runGame); // AnimationFrame 실행
                    if ( y > canvasBottom ) { // 아래쪽 벽이 나오면 멈춘다.
                        dy = 0;
                        if ( x < canvasLeft ) { // 왼쪽 벽이 나오면 멈춘다.
                            dx = 0;
                            break;
                        }
                        if ( x > canvasRight ) { // 오른쪽 벽이 나오면 멈춘다.
                            dx = 0;
                            break;
                        }
                        break;
                    } else { // 아래쪽 벽이 나오기 전까지 움직인다.
                        dy = 5;
                        if ( x < canvasLeft ) { // 왼쪽 벽이 나오면 멈춘다.
                            dx = 0;
                            break;
                        }
                        if ( x > canvasRight ) { // 오른쪽 벽이 나오면 멈춘다.
                            dx = 0;
                            break;
                        }
                        break;
                    }
            }
        }

        // 눌린 키가 떼졌을때 실행되는 메소드 - 멈춤 상태
        function keyUp() {
            keycode = event.keyCode; // 키보드 키코드
            switch(keycode) {
                // x축 멈춤
                case 37:
                case 39:
                    dx = 0;
                    break;
                // y축 멈춤
                case 38:
                case 40:
                    dy = 0;
                    break;
            }
        }
    </script>
</body>
</html>